
/*!
 * @package     pwebbox
 * @version 	2.0.9
 *
 * @copyright   Copyright (C) 2015 Perfect Web. All rights reserved. http://www.perfect-web.co
 * @license     GNU General Public Licence http://www.gnu.org/licenses/gpl-3.0.html
 * 
 * jQuery 1.8+
 */
var pwebBoxes=pwebBoxes||[],pwebbox_l10n=pwebbox_l10n||{};!function(a){pwebBox=function(a){this.init(a)},pwebBox.prototype=function(){return{constructor:pwebBox,defaults:{id:"",selector:"#pwebbox",selectorClass:".pwebbox",debug:!1,bootstrap:2,openAuto:!1,openDelay:0,maxAutoOpen:0,closeAuto:!1,closeDelay:0,closeOther:!0,layout:"slidebox",theme:"",position:"left",offsetPosition:"top",msgCloseDelay:10,togglerNameOpen:"",togglerNameClose:"",slideWidth:0,slideDuration:400,slideTransition:"swing",accordionDuration:500,accordionEaseIn:"easeInBack",accordionEaseOut:"easeOutBounce",modalBackdrop:!0,modalClose:!0,modalStyle:"default",modalEffect:"fade",modalEffectDuration:400,modalEaseIn:"easeInCubic",modalEaseOut:"easeOutCubic",cookieLifetime:30,cookiePath:"/",cookieDomain:"",onLoad:function(){},onOpen:function(){},onClose:function(){},onTrack:function(){}},status:0,hidden:!0,timer:!1,init:function(b){var c=this;if(this.options=a.extend({},this.defaults,b),this.options.selector=this.options.selector+this.options.id,this.options.selectorClass=this.options.selectorClass+this.options.id,this.element=a(this.options.selector),this.Content=a(this.options.selector+"_content"),this.Toggler=a(this.options.selector+"_toggler"),this.Box=a(this.options.selector+"_box"),this.Container=a(this.options.selector+"_container"),this.options.autoClose=this.options.closeDelay>0,this.options.tracked=!1,this.options.openEvent="click",this.Box.hasClass("pweb-open-event-mouseenter")&&(this.options.openEvent="mouseenter"),this.options.closeEvent="click",this.Box.hasClass("pweb-close-event-mouseleave")&&(this.options.closeEvent="mouseleave"),a('a[href="'+this.options.selector+'_toggler"]').addClass(this.options.selector.replace("#","")+"_toggler"),"slidebox"==this.options.layout)this.element.appendTo(document.body),this.initSlidebox();else if("modal"==this.options.layout){if(this.element.appendTo(document.body),!this.initModal())return!1}else"accordion"==this.options.layout&&this.initAccordion();this.options.onLoad.apply(this),this.element.trigger("onLoad");var d=!1;if(document.location.hash.indexOf(this.options.selector+":")!==-1){var e=document.location.hash.replace(this.options.selector+":","");0!==e.indexOf("open")||"undefined"!=typeof e[4]&&":"!=e[4]||(e=e.replace(/open(:)?/i,""),d=!0)}if("static"!=this.options.layout){if("click"==this.options.openEvent&&"click"==this.options.closeEvent)a(this.options.selectorClass+"_toggler").click(function(a){a.preventDefault(),c.toggleBox(-1,-1,this,a)});else if(this.Box.find(".pweb-button-close").click(function(a){a.preventDefault(),c.toggleBox(-1,-1,this,a)}),"mouseenter"==this.options.openEvent?a(this.Toggler).mouseenter(function(a){a.preventDefault(),c.toggleBox(1,1,this,a)}):a(this.Toggler).click(function(a){a.preventDefault(),c.toggleBox(1,1,this,a)}),"mouseleave"==this.options.closeEvent){var f=this.element;"modal"==this.options.layout&&(f=this.Box),a(f).mouseleave(function(a){c.Toggler.hasClass("pweb-opened")&&(a.preventDefault(),c.toggleBox(0,-1,this,a))})}else a(this.Toggler).click(function(a){c.Toggler.hasClass("pweb-opened")&&(a.preventDefault(),c.toggleBox(0,-1,this,a))});if(this.options.togglerNameClose&&(this.options.togglerNameOpen=this.Toggler.find(".pweb-text").text()),this.options.closeOther&&pwebBoxes.push(this),d)this.autoPopupOnPageLoad();else if(this.options.openAuto)switch(this.options.maxAutoOpen>0&&(this.initAutoPopupCookie()||(this.options.openAuto=!1)),this.options.openAuto){case 1:this.autoPopupOnPageLoad();break;case 2:this.autoPopupOnPageScroll();break;case 3:this.autoPopupOnPageExit()}if("bottombar"==c.options.layout){var g=a(c.options.selector).find(".pwebbox-container").outerHeight();c.Toggler.height(g).css("line-height",g+"px")}a(window).resize(function(){if("bottombar"==c.options.layout){var b=a(c.options.selector).find(".pwebbox-container").outerHeight();c.Toggler.height(b).css("line-height",b+"px")}})}return this.initHiddenFields(),this},initSlidebox:function(){var b=this;this.options.togglerSlide=this.Box.hasClass("pweb-toggler-slide"),this.options.togglerHidden=this.Box.hasClass("pweb-toggler-hidden"),this.options.slidePos=this.element.css("position"),this.options.slideWidth||(this.options.slideWidth=parseInt(this.Box.css("max-width"))),this.Box.css("width",this.options.slideWidth),"left"==this.options.position||"right"==this.options.position?(this.Box.css(this.options.position,-this.options.slideWidth),this.options.togglerWidth=this.options.togglerSlide?this.Toggler.outerWidth():0,this.options.togglerHeight=this.options.togglerSlide?parseInt(this.Box.css("top")):0,this.options.slideOffset=parseInt(this.element.css("top")),this.options.togglerSlide&&this.Toggler.css("left"==this.options.position?"right":"left",-this.Toggler.outerWidth())):(setTimeout(function(){b.Box.css(b.options.position,-b.Box.height())},100),this.options.togglerWidth=0,this.options.togglerHeight=this.options.togglerSlide?this.Toggler.outerHeight():0,this.options.slideOffset=0,this.options.togglerSlide&&this.Toggler.css("top"==this.options.position?"bottom":"top",-this.Toggler.outerHeight())),this.Box.addClass("pweb-closed"),setTimeout(function(){b.Box.removeClass("pweb-init")},100),this.options.togglerHidden&&(this.Toggler.fadeOut(0).removeClass("pweb-closed").addClass("pweb-opened"),this.options.togglerNameClose&&this.Toggler.find(".pweb-text").text(this.options.togglerNameClose)),this.isFF=navigator.userAgent.indexOf("Gecko")!=-1,a(window).scroll(function(c){if(!b.hidden&&"absolute"==b.element.css("position")&&"fixed"==b.options.slidePos){var d=a(this).scrollTop();"bottom"==b.options.position?(d+=a(this).height(),d>b.element.offset().top&&(b.isFF?b.element.css("top",d):b.element.stop().animate({top:d},250,"linear"))):(d+=b.options.slideOffset,d<b.element.offset().top&&(b.isFF?b.element.css("top",d):b.element.stop().animate({top:d},250,"linear")))}}),a(window).resize(function(){if(!b.hidden){var c={width:b.options.slideWidth},d=a(window).width();if("left"==b.options.position||"right"==b.options.position)b.options.slideWidth+b.options.togglerWidth>d&&(c.width=d-b.options.togglerWidth);else{var e=b.element.offset().left;"right"==b.options.offsetPosition&&(e=a(document).width()-e),b.options.slideWidth+e>d&&(c.width=d-e)}if(b.Box.css(c),"fixed"==b.options.slidePos){var c={position:"absolute"};"left"==b.options.position||"right"==b.options.position?(c.top=b.element.offset().top,b.Box.height()+b.options.togglerHeight+c.top-a(window).scrollTop()<=a(window).height()&&(c.position="fixed",c.top=b.options.slideOffset)):b.Box.height()+b.options.togglerHeight>a(window).height()?(c.top=b.element.offset().top,"bottom"==b.options.position&&(c.bottom="auto")):(c.position="fixed",c[b.options.position]=0,"bottom"==b.options.position&&(c.top="auto")),b.element.css(c)}}})},initModal:function(){var b=this;return"function"==typeof a.fn.modal?(this.Modal=a(this.options.selector+"_modal"),this.options.modalClass="pwebbox"+this.options.id+"_modal-open pweb-modal-open"+(this.options.theme?" pweb-theme-"+this.options.theme+"-modal":"")+" pweb-modal-"+this.options.modalStyle,this.Modal.appendTo(document.body).modal({show:!1,keyboard:!1,backdrop:!this.options.modalClose&&this.options.modalBackdrop?"static":this.options.modalBackdrop}).on(2===this.options.bootstrap?"hidden":"hidden.bs.modal",function(c){c.stopPropagation(),c.target===c.currentTarget&&(b.toggleBox(0),a(document.body).removeClass(b.options.modalClass),b.Box.addClass("pweb-closed"))}).on(2===this.options.bootstrap?"show":"show.bs.modal",function(c){c.stopPropagation(),c.target===c.currentTarget&&(a(document.body).addClass(b.options.modalClass),b.Box.removeClass("pweb-closed"))}).click(function(a){a.target===a.currentTarget&&b.options.modalClose&&b.toggleBox(0)}),"fade"!==this.options.modalEffect&&"drop"!==this.options.modalEffect&&this.initGenie(),!0):(this.options.debug&&this.debug("Bootstrap Modal Plugin is not loaded"),!1)},initGenie:function(){var b=this,c=this.Box.attr("class").match(/pweb-bg-[a-z]+/i);this.options.modalGenieClass="pweb-genie pweb-"+this.options.modalEffect+"-"+("static"!==this.options.position?this.options.position:"bottom")+" pwebbox"+this.options.id+"-genie"+(this.options.theme?" pweb-theme-"+this.options.theme:"")+(this.Box.hasClass("pweb-radius")?" pweb-radius":"")+(this.Box.hasClass("pweb-shadow")?" pweb-shadow":"")+(c?" "+c[0]:""),"smooth"===this.options.modalEffect?(this.options.modalEaseIn="easeInQuart",this.options.modalEaseOut="easeOutQuart"):"rotate"===this.options.modalEffect&&(this.options.modalEaseIn="easeInQuint",this.options.modalEaseOut="easeOutQuint"),this.Modal.on(2===this.options.bootstrap?"show":"show.bs.modal",function(c){c.stopPropagation(),c.target===c.currentTarget&&"undefined"!=typeof b.eventSource&&a(b.eventSource).length&&b.Container.css({visibility:"hidden",opacity:0})}).on(2===this.options.bootstrap?"shown":"shown.bs.modal",function(c){c.stopPropagation(),c.target===c.currentTarget&&"undefined"!=typeof b.eventSource&&a(b.eventSource).length&&a(b.eventSource).trigger("modalOpen")}),a(this.options.selectorClass+"_toggler").on("modalOpen",function(){a(this).effect({effect:"transfer",to:b.Container,duration:b.options.modalEffectDuration,easing:b.options.modalEaseIn,className:"pweb-genie-show "+b.options.modalGenieClass,complete:function(){b.Container.css({visibility:"visible",opacity:1})}})}),this.Container.on("modalClose",function(){a(this).css({visibility:"hidden",opacity:0}).effect({effect:"transfer",to:a(b.eventSource),duration:b.options.modalEffectDuration,easing:b.options.modalEaseOut,className:"pweb-genie-hide "+b.options.modalGenieClass,complete:function(){b.Modal.modal("hide")}})})},initAccordion:function(){var b=this;return a(this.options.selectorClass+"_toggler").on("openAccordion",function(){b.Box.removeClass("pweb-closed").slideDown({duration:b.options.accordionDuration,easing:b.options.accordionEaseOut,complete:function(){var c=a(window).height(),d=b.element.outerHeight(),e=b.element.offset().top;e+d>a(window).scrollTop()+c&&(d<c&&(e=e+d-c),a("html,body").animate({scrollTop:parseInt(e)},500)),a(b.Toggler).trigger("openedAccordion")}})}),a(this.element).on("closeAccordion",function(){b.Box.slideUp({duration:b.options.accordionDuration,easing:b.options.accordionEaseIn,complete:function(){b.Box.addClass("pweb-closed")}})}),this.Box.css("display","none").removeClass("pweb-init"),!0},initHiddenFields:function(){return a("<input/>",{type:"hidden",name:"screen_resolution",value:screen.width+"x"+screen.height}).appendTo(this.Content),this.options.debug&&a("<input/>",{type:"hidden",name:"debug",value:1}).appendTo(this.Content),!0},close:function(){this.toggleBox(0)},toggleBox:function(b,c,d,e){var f=this;if("undefined"==typeof b&&(b=-1),"undefined"==typeof d&&(d=this.Toggler),this.hidden||b!==-1&&0!==b){if(this.hidden&&(b===-1||1===b)){if(this.options.closeOther&&a.each(pwebBoxes,function(){this.options.id!=f.options.id&&"function"==typeof this.close&&this.close()}),1!==this.options.openAuto&&2!==this.options.openAuto||(this.options.openAuto=!1,this.timer&&clearTimeout(this.timer)),this.hidden=!1,this.Toggler.length&&!this.options.togglerHidden&&(this.Toggler.removeClass("pweb-closed").addClass("pweb-opened"),this.options.togglerNameClose&&this.Toggler.find(".pweb-text").text(this.options.togglerNameClose)),"slidebox"==this.options.layout){var g={width:this.options.slideWidth};g[this.options.position]=0;var h=a(window).width();if("left"==this.options.position||"right"==this.options.position)this.options.slideWidth+this.options.togglerWidth>h&&(g.width=h-this.options.togglerWidth);else{var i=this.element.offset().left;"right"==this.options.offsetPosition&&(i=a(document).width()-i),this.options.slideWidth+i>h&&(g.width=h-i)}this.Box.stop(!0,!1).animate(g,this.options.slideDuration,this.options.slideTransition,function(){if("fixed"==f.options.slidePos){var b={position:"absolute"};"left"==f.options.position||"right"==f.options.position?(b.top=f.element.offset().top,f.Box.height()+f.options.togglerHeight+b.top-a(window).scrollTop()>a(window).height()&&(b.top=f.element.offset().top,f.element.css(b))):f.Box.height()+f.options.togglerHeight>a(window).height()&&(b.top=f.element.offset().top,"bottom"==f.options.position&&(b.bottom="auto"),f.element.css(b))}a(d).trigger("shownSlidebox")}).css("overflow","visible").removeClass("pweb-closed"),this.options.togglerHidden&&this.Toggler.fadeIn(this.options.slideDuration)}else"modal"==this.options.layout?("fade"!==this.options.modalEffect&&"drop"!==this.options.modalEffect&&a(d).length&&(this.eventSource=d),this.Modal.modal("show")):"accordion"==this.options.layout?a(d).trigger("openAccordion"):"bottombar"==this.options.layout&&this.Box.parent().show();this.options.onOpen.apply(this),this.element.trigger("onOpen"),this.options.tracked||(this.options.tracked=!0,this.options.onTrack.apply(this),this.element.trigger("onTrack")),this.autoClose()}}else{if(this.hidden=!0,this.Toggler.length&&!this.options.togglerHidden&&(this.Toggler.removeClass("pweb-opened").addClass("pweb-closed"),this.options.togglerNameClose&&this.Toggler.find(".pweb-text").text(this.options.togglerNameOpen)),this.options.openAuto===!1&&this.timer&&clearTimeout(this.timer),"slidebox"==this.options.layout){var g={};g[this.options.position]="left"==this.options.position||"right"==this.options.position?-this.Box.width():-this.Box.height(),this.Box.stop(!0,!1).animate(g,this.options.slideDuration,this.options.slideTransition,function(){if(f.Box.addClass("pweb-closed"),"absolute"==f.element.css("position")&&"fixed"==f.options.slidePos){var b={position:"fixed"};"left"==f.options.position||"right"==f.options.position?b.top=f.options.slideOffset:(b[f.options.position]=0,"bottom"==f.options.position&&(b.top="auto")),f.element.css(b)}a(d).trigger("closedSlidebox")}),this.options.togglerHidden&&this.Toggler.fadeOut(this.options.slideDuration)}else"modal"==this.options.layout?"fade"!==this.options.modalEffect&&"drop"!==this.options.modalEffect&&"undefined"!=typeof this.eventSource?this.Container.trigger("modalClose"):this.Modal.modal("hide"):"accordion"==this.options.layout?a(d).trigger("closeAccordion"):"bottombar"==this.options.layout&&this.element.hide();this.options.onClose.apply(this),this.element.trigger("onClose")}},initAutoPopupCookie:function(){if("function"==typeof a.cookie){var b=parseInt(a.cookie("pwebbox"+this.options.id+"_openauto"));if(b=isNaN(b)?1:b+1,b<=this.options.maxAutoOpen)return a.cookie("pwebbox"+this.options.id+"_openauto",b,{domain:this.options.cookieDomain,path:this.options.cookiePath,expires:this.options.cookieLifetime}),!0}else this.options.debug&&this.debug("jQuery Cookie Plugin is not loaded");return!1},autoPopupOnPageLoad:function(){this.options.openDelay?this.timer=this.delay(this.toggleBox,this.options.openDelay,this,[1]):this.toggleBox(1)},autoPopupOnPageScroll:function(){var b=this;this.autoOpen=!0,a(window).scroll(function(){b.autoOpen&&(b.autoOpen=!1,b.options.openDelay?b.timer=b.delay(b.toggleBox,b.options.openDelay,b,[1]):b.toggleBox(1))})},autoPopupOnPageExit:function(){var b=this;this.autoOpen=-1,a(window).mousemove(function(a){b.autoOpen==-1&&a.clientY>70?b.autoOpen=1:1==b.autoOpen&&a.clientY<30&&(b.autoOpen=0,b.options.openDelay?b.timer=b.delay(b.toggleBox,b.options.openDelay,b,[1]):b.toggleBox(1))})},autoClose:function(){this.options.autoClose&&(this.options.closeDelay?this.timer=this.delay(this.toggleBox,this.options.closeDelay,this,[0]):this.toggleBox(0))},delay:function(a,b,c,d){return setTimeout(function(){return a.apply(c,d||arguments)},b)},displayAlert:function(b,c,d,e){if("function"==typeof a.fn.alert){var f=a('<div class="pweb-alert alert alert-block '+(c?"alert-"+c:"")+' fade in"><button data-dismiss="alert" class="close" type="button">&times;</button>'+("undefined"!=typeof d?'<h4 class="alert-heading">'+d+"</h4>":"")+"<p>"+b+"</p></div>").alert().appendTo(document.body);("undefined"==typeof e||e)&&this.options.msgCloseDelay&&setTimeout(function(){f.alert("close")},1e3*this.options.msgCloseDelay)}else alert(b.replace("<br>","\r\n"))},debug:function(b,c){a.isArray(b)&&(b=b.join("<br>")),"undefined"!=typeof c&&(b=b+"<br>Response code: "+c),this.displayAlert(b,"info","Perfect Popup Box",!1)}}}(),pwebBox.options=pwebBox.prototype.options}(window.jQuery);